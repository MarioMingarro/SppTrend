% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/spp_trend.R
\name{spp_trend}
\alias{spp_trend}
\title{Individual trend analysis}
\usage{
spp_trend(data, spp, predictor, responses, n_min = 50)
}
\arguments{
\item{data}{A \verb{data frame} containing the variables for the model, including 'species', 'year', 'month', 'lon', 'lat', 'tmx' and/or similar.}

\item{spp}{A \code{character} vector of unique species names.}

\item{predictor}{A \code{character}vector of predictor variable names representing a temporal variable (e.g., "year_month").}

\item{responses}{A \code{character} vector of response variable names to analyze (e.g., "lat"  for spatial trends, "tmx" for thermal trends).}

\item{n_min}{Minimum \code{numeric} number of presences required for a species in each hemisphere (or globally for species in both hemispheres) to perform the analysis.}
}
\value{
A data frame with trend statistics, including:
\itemize{
\item \code{species}: Species name.
\item \code{responses}: The name of the variable analyzed.
\item \code{trend}: The slope of the linear model, indicating the direction and magnitude of the trend.
\item \code{t}: The t-statistic of the model, used to assess the significance of the trend.
\item \code{pvalue}: The p-value of the trend, indicating the probability of observing such a trend if there was no actual trend.
\item \code{ci_95_max}: Upper bound of the 95\% confidence interval for the trend.
\item \code{ci_95_min}: Lower bound of the 95\% confidence interval for the trend.
\item \code{dif_t}: Difference in t-statistic values (comparison of species trend to general trend).
\item \code{dif_pvalue}: Difference in p-values (comparison of species trend to general trend). A low p-value here suggests the species trend is significantly different from the general trend.
\item \code{n}: Number of datapoints used for the specific species/hemisphere trend.
\item \code{hemisphere}: Detected hemisphere ("North", "South", or "Both" for global comparison).
}
}
\description{
This function fits a linear model to analyze individual trends over time, comparing with a general data trend (\code{overall_trend}),
and includes longitude transformation to handle the antimeridian and hemisphere detection. For species distributed across both hemispheres, it also compares their overall trend
with the global data trend. The comparison with the general trend is assessed using an interaction term in the linear model.
}
\details{
The function analyzes trends for each species in the provided data,
considering different response variables and a specified temporal predictor.
It accounts for the antimeridian issue when analyzing longitude trends by
transforming longitude values. The analysis is performed separately
for each hemisphere to capture potential differences in ecological responses.
The function compares the trend of each species within a hemisphere with a
general trend calculated from the entire hemisphere's data. For species
found in both the Northern and Southern Hemispheres, it additionally compares
the trend of the species (using all occurrences) with the trend of the entire
dataset (all hemispheres combined), providing a global perspective on the
species' trend. Warnings are generated if a species has insufficient data
(below \code{n_min}) in a given hemisphere or globally, or if errors occur during
the linear model fitting process. This function typically follows the
calculation of an overall trend using a function like \code{overall_trend()}.
}
\examples{

data <- data.frame(
   species = sample(paste0("spp_", 1:10), 500, replace = TRUE),
   year = sample(1950:2020, 500, replace = TRUE),
   month = sample(1:12, 500, replace = TRUE),
   lon = runif(500, -10, 20),
   lat = runif(500, 30, 70),
   tme = rnorm(500, 15, 10)
)

data$year_month <- data$year + data$month * 0.075

predictor <- "year_month"
responses <- c("lat", "lon", "tme")

spp <- unique(data$species)

spp_trend_result <- spp_trend(data, spp, predictor, responses, n_min = 50)

print(head(spp_trend_result))

# Example interpretation: A positive 'trend' for 'lat' might indicate a
# northward shift in the Northern Hemisphere. A low 'pvalue' (e.g., < 0.05)
# suggests this trend is statistically significant. A low 'dif_pvalue'
# might indicate this trend is significantly different from the general trend.

}
